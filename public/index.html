
<!doctype html><html><head><meta charset="utf-8"><title>Mini Twitter</title><link rel="stylesheet" href="/styles.css"></head><body>
<div class="container"><aside class="sidebar"><div class="brand card"><div class="logo">üê¶</div><div><div style="font-weight:800">Mini Twitter</div><div style="color:var(--muted);font-size:13px">Demo</div></div></div><nav class="nav" style="margin-top:16px"><a href="/" style="color:var(--accent);">Home</a><a href="/explore.html">Explore</a><a href="/notifications.html">Notifications</a><a href="/messages.html">Messages</a></nav><div style="margin-top:18px" class="card"><div style="font-weight:700;margin-bottom:8px">Profile</div><div id="profileArea"><a href="/login.html" style="color:var(--muted)">Login / Register</a></div></div></aside><main class="main"><section class="card"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><h2 style="margin:0">Home</h2><div id="rightHeader"></div></div><div id="composer" class="tweet-box" style="display:none"><div class="avatar" id="avatar">U</div><div class="tweet-input"><textarea id="tweetText" rows="3" placeholder="What's happening?"></textarea><div class="tweet-row"><div class="small" id="count">0 / 280</div><div><button id="tweetBtn" class="button">Tweet</button></div></div></div></div><div id="loginNotice" style="padding:12px;color:var(--muted);display:none">Please <a href="/login.html">login</a> to post tweets.</div><div class="timeline" id="tweets"></div></section></main></div><script>async function getMe(){ const token=localStorage.getItem('token'); if(!token) return null; try{ const r=await fetch('/api/me',{headers:{Authorization:'Bearer '+token}}); if(!r.ok){ localStorage.removeItem('token'); return null;} return await r.json(); }catch(e){return null;} } async function loadTweets(){ try{ const r=await fetch('/api/tweets'); const tweets=await r.json(); const c=document.getElementById('tweets'); c.innerHTML=''; tweets.forEach(t=>{ const el=document.createElement('div'); el.className='tweet'; el.innerHTML='<div style="width:56px"><div class="avatar">'+(t.user? t.user[0].toUpperCase():'A')+'</div></div><div style="flex:1"><div class="meta">'+(t.user||'anonymous')+'</div><div>'+t.text+'</div><div class="small">'+new Date(t.createdAt).toLocaleString()+'</div></div>'; c.appendChild(el); }); }catch(e){console.error(e);} } document.getElementById('tweetBtn').addEventListener('click', async ()=>{ const text=document.getElementById('tweetText').value; if(!text.trim()){ alert('Write something'); return;} const token=localStorage.getItem('token'); if(!token){ alert('Please login'); window.location.href='/login.html'; return;} try{ const r=await fetch('/api/tweets',{method:'POST',headers:{'Content-Type':'application/json',Authorization:'Bearer '+token},body:JSON.stringify({text})}); if(!r.ok){ const d=await r.json(); alert(d.message||'Could not post'); return;} document.getElementById('tweetText').value=''; loadTweets(); }catch(e){alert('Error');console.error(e);} }); document.getElementById('tweetText').addEventListener('input',(e)=>{ document.getElementById('count').textContent = e.target.value.length + ' / 280'; }); (async ()=>{ await loadTweets(); const me=await getMe(); if(me && me.username){ document.getElementById('composer').style.display='flex'; document.getElementById('loginNotice').style.display='none'; document.getElementById('avatar').textContent = me.username[0].toUpperCase(); document.getElementById('rightHeader').innerHTML = '<span style="color:var(--muted);margin-right:8px">Logged in as <strong>'+me.username+'</strong></span><button id="logout" class="button" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Logout</button>'; document.getElementById('logout').addEventListener('click', ()=>{ localStorage.removeItem('token'); window.location.href='/login.html'; }); } else { document.getElementById('composer').style.display='none'; document.getElementById('loginNotice').style.display='block'; document.getElementById('rightHeader').innerHTML = '<a href="/login.html" style="padding:8px 12px;border-radius:10px;background:var(--accent);color:white;text-decoration:none">Login</a>'; } })(); </script></html>